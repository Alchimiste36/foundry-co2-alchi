{{log "Chroniques Oubli√©es | feature" this}}
<section class="tab standard-form feature{{#if tabs.details.active}} active{{/if}}" data-group="primary" data-tab="details">

    {{#if debugMode}}
        <fieldset class="debug">
            <legend>{{localize "CO.ui.debug"}}</legend>
            {{formGroup fields._id value=item.id disabled=true localize=true label="CO.ui.id"}}
            {{formGroup systemFields.slug value=system.slug disabled=true localize=true}}
        </fieldset>
    {{/if}}

    <div class="form-group">
        <label>{{localize "CO.label.long.subtype"}}</label>
        <div class="form-fields">
            <select name="system.subtype" data-type="String">
                {{selectOptions choiceFeatureSubtypes selected=systemSource.subtype localize=true}}
            </select>
        </div>
    </div>

    <!-- MODIFIERS -->
    <h3 class="form-header"><a class="section-toggle">{{localize "CO.label.long.modifiers"}}</a></h3>
    <div class="modifiers-container foldable">
        {{#if modifiers}}
            <div class="flexrow">
            <div class="form-fields flex1 center">{{localize "CO.ui.type"}}</div>
            <div class="form-fields flex1 center">{{localize "CO.ui.target"}}</div>
            <div class="form-fields flex1 center">{{localize "CO.ui.value"}}</div>
            <div class="form-fields flex0"></div>
            </div>
            {{#each modifiers as |m id|}}
                <div class="modifier flexrow" data-item-id="{{id}}" data-item-type="modifier">
                    <input name="system.modifiers.{{id}}.type" type="hidden" value="{{m.type}}" data-dtype="String" />
                    <input name="system.modifiers.{{id}}.source" type="hidden" value="{{m.source}}" data-dtype="String" />
                    <div class="form-fields flex1">
                    <select name="system.modifiers.{{id}}.subtype" data-type="String" style="width:100%">
                        {{selectOptions @root.choiceModifierSubtypes selected=m.subtype localize=true}}
                    </select>
                    </div>
                    <div class="form-fields flex1">
                    <select name="system.modifiers.{{id}}.target" data-type="String" style="width:100%">
                        {{selectOptions @root.choiceModifierTargets selected=m.target localize=true}}
                    </select>
                    </div>
                    <div class="form-fields flex1 center"><input name="system.modifiers.{{id}}.value" type="text" value="{{m.value}}" data-dtype="String" /></div>
                    <div class="form-fields flex0"><button data-action="deleteModifier"><i class="fas fa-trash"></i></button></div>
                </div>
            {{/each}}
        {{else}}
            <div class="flexrow">
                <span>Aucun modificateur.</span>
            </div>
        {{/if}}
        <div class="flexrow">
            <button class="center" data-action="addModifier" data-tooltip="{{localize 'CO.ui.add'}}"><i class="fas fa-add"></i></button>
        </div>
    </div>

    <!-- PATHS -->
    <h3 class="form-header"><a class="section-toggle">{{localize "CO.label.long.paths"}}</a></h3>
    <div class="path-list list-3col foldable">
        {{#each paths as |item id|}}
            {{!log 'path' item id}}
            <div class="cell center item" data-uuid="{{item.uuid}}" data-item-type="path">
                <a class="item-control item-edit"><img class="inline-img" src="{{item.img}}" data-tooltip="{{item.name}}" /></a>
            </div>
            <div class="cell left">
                <div class="field-label ellipse">{{item.name}}</div>
            </div>
            <div class="cell right item item-controls" data-uuid="{{item.uuid}}" data-item-type="path">
                <button type="button" class="item-control" data-action="deleteItem" data-tooltip="{{localize 'CO.label.long.deleteItem'}}"><i class="fas fa-trash"></i></button>
            </div>
        {{/each}}
    </div>

    <!-- CAPACITIES -->
    <h3 class="form-header"><a class="section-toggle">{{localize "CO.label.long.capacities"}}</a></h3>
    <div class="capacity-list list-3col foldable">
        {{#each capacities as |item id|}}
            {{!log 'capacity' item id}}
            <div class="cell center item" data-uuid="{{item.uuid}}" data-item-type="capacity">
                <a class="item-control item-edit"><img class="inline-img" src="{{item.img}}" data-tooltip="{{item.name}}" /></a>
            </div>
            <div class="cell left">
                <div class="field-label ellipse">{{item.name}}</div>
            </div>
            <div class="cell right item item-controls" data-uuid="{{item.uuid}}" data-item-type="capacity">
                <button type="button" class="item-control" data-action="deleteItem" data-tooltip="{{localize 'CO.label.long.deleteItem'}}"><i class="fas fa-trash"></i></button>
            </div>
        {{/each}}
    </div>    
</section>