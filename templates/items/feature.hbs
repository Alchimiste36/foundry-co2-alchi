{{log "Chroniques Oubli√©es | feature" this}}
<section class="tab standard-form feature{{#if tabs.details.active}} active{{/if}}" data-group="primary" data-tab="details">

    <section class="halfPanel">
        <section class="panelLeft">

            {{#if debugMode}}
                <fieldset class="debug">
                    <legend>{{localize "CO.ui.debug"}}</legend>
                    {{formGroup fields._id value=item.id disabled=true localize=true label="CO.ui.id"}}
                    {{formGroup systemFields.slug value=system.slug disabled=true localize=true}}
                </fieldset>
            {{/if}}

            <fieldSet class="infoInitial">
                <legend>{{localize "CO.ui.initialInformations"}}</legend>
                <div class="form-group">
                    <label>{{localize "CO.label.long.subtype"}}</label>
                    <div class="form-fields">
                        <select name="system.subtype" data-type="String" {{#if locked}}disabled{{/if}}>
                            {{selectOptions choiceFeatureSubtypes selected=systemSource.subtype localize=true}}
                        </select>
                    </div>
                </div>
            </fieldSet> 
        
            <!-- CAPACITIES -->
            <h4 class="form-header">
                <a data-action="toggleSection">{{localize "CO.label.long.capacities"}}</a>
            </h4>
            <div class="capacity-list list-3col foldable">
                {{#each capacities as |item id|}}
                    {{!log 'capacity' item id}}
                    <div class="cell center item" data-uuid="{{item.uuid}}" data-item-type="capacity">
                        <a class="item-control item-edit"><img class="inline-img" src="{{item.img}}" data-tooltip="{{item.name}}" /></a>
                    </div>
                    <div class="cell left">
                        <div class="field-label ellipse">{{item.name}}</div>
                    </div>
                    <div class="cell right item item-controls" data-uuid="{{item.uuid}}" data-item-type="capacity">
                        {{#if @root.unlocked}}
                            <button type="button" class="item-control" data-action="deleteItem" data-tooltip="{{localize 'CO.label.long.deleteItem'}}"><i class="fas fa-trash"></i></button>
                        {{/if}} 
                    </div>
                {{/each}}
            </div>    
        </section>
        <section class="panelRight">

            <!-- PATHS -->
            <h4 class="form-header">
                <a data-action="toggleSection">{{localize "CO.label.long.paths"}}</a>
            </h4>
            <div class="path-list list-3col foldable">
                {{#each paths as |item id|}}
                    {{!log 'path' item id}}
                    <div class="cell center item" data-uuid="{{item.uuid}}" data-item-type="path">
                        <a class="item-control item-edit"><img class="inline-img" src="{{item.img}}" data-tooltip="{{item.name}}" /></a>
                    </div>
                    <div class="cell left">
                        <div class="field-label ellipse">{{item.name}}</div>
                    </div>
                    <div class="cell right item item-controls" data-uuid="{{item.uuid}}" data-item-type="path">
                        {{#if @root.unlocked}}
                            <button type="button" class="item-control" data-action="deleteItem" data-tooltip="{{localize 'CO.label.long.deleteItem'}}"><i class="fas fa-trash"></i></button>
                        {{/if}}
                    </div>
                {{/each}}
            </div>
        </section>    
    </section>
    
   <!-- MODIFIERS -->
    <h4 class="form-header">
        <a data-action="toggleSection">{{localize "CO.label.long.modifiers"}}</a>
        {{#if @root.unlocked}}<a data-action="addModifier" data-tooltip="{{localize 'CO.ui.add'}}"><i class="fas fa-add"></i></a>{{/if}}
    </h4>
    <div class="modifiers-container foldable">
        {{#if modifiers}}
            <div class="form-group-stacked like-grid">
                <label>
                    <span>{{localize "CO.ui.type"}}</span>
                    <span>{{localize "CO.ui.target"}}</span>
                    <span>{{localize "CO.ui.value"}}</span>
                    <span></span>
                </label>
            {{#each modifiers as |m id|}}
                <input name="system.modifiers.{{id}}.type" type="hidden" value="{{m.type}}" data-dtype="String" {{#if @root.locked}}disabled{{/if}}/>
                <input name="system.modifiers.{{id}}.source" type="hidden" value="{{m.source}}" data-dtype="String" {{#if @root.locked}}disabled{{/if}}/>
                <div class="form-fields modifier flexrow" data-item-id="{{id}}" data-item-type="modifier">
                    <select name="system.modifiers.{{id}}.subtype" data-type="String" {{#if @root.locked}}disabled{{/if}}>
                        {{selectOptions @root.choiceModifierSubtypes selected=m.subtype localize=true}}
                    </select>
                    <select name="system.modifiers.{{id}}.target" data-type="String" {{#if @root.locked}}disabled{{/if}}>
                        {{#if (eq m.subtype 'ability')}}
                            {{selectOptions @root.choiceModifierAbilityTargets selected=m.target localize=true}}
                        {{/if}}
                        {{#if (eq m.subtype 'combat')}}
                            {{selectOptions @root.choiceModifierCombatTargets selected=m.target localize=true}}
                        {{/if}}
                        {{#if (eq m.subtype 'attribute')}}
                            {{selectOptions @root.choiceModifierAttributeTargets selected=m.target localize=true}}
                        {{/if}}                        
                        {{#if (eq m.subtype 'resource')}}
                            {{selectOptions @root.choiceModifierResourceTargets selected=m.target localize=true}}
                        {{/if}}                        
                        {{#if (eq m.subtype 'skill')}}
                            {{selectOptions @root.choiceModifierSkillTargets selected=m.target localize=true}}
                        {{/if}}
                        {{#if (eq m.subtype 'state')}}
                            {{selectOptions @root.choiceModifierStateTargets selected=m.target localize=true}}
                        {{/if}}
                        {{#if (eq m.subtype 'bonusDice')}}
                            {{selectOptions @root.choiceModifierBonusDiceTargets selected=m.target localize=true}}
                        {{/if}}
                        {{#if (eq m.subtype 'malusDice')}}
                            {{selectOptions @root.choiceModifierMalusDiceTargets selected=m.target localize=true}}
                        {{/if}}   
                    </select>
                    <input name="system.modifiers.{{id}}.value" type="text" value="{{m.value}}" data-dtype="String" {{#if @root.locked}}disabled{{/if}}/>
                    {{#if @root.unlocked}}<button data-action="deleteModifier"><i class="fas fa-trash"></i></button>{{/if}}
                </div>
            {{/each}}
            </div>            
        {{else}}
            <div class="empty">
                <span>{{localize "CO.ui.noneModif"}}</span>
            </div>
        {{/if}}
    </div>

</section>
